{"componentChunkName":"component---src-templates-example-js","path":"/canary/","webpackCompilationHash":"4c97b8867ce8cc5e8d2c","result":{"data":{"site":{"siteMetadata":{"title":"Istio By Example","author":"Megan O'Keefe"}},"markdownRemark":{"id":"eb4934d0-04a4-5d06-98de-4852d98bc460","excerpt":"A canary deployment is a strategy for safely rolling out a new version of a service. With Istio, you can use percentage-based traffic splitting to direct a…","html":"<p>A canary deployment is a strategy for safely rolling out a new version of a service. With Istio, you can use percentage-based <a href=\"https://istio.io/docs/concepts/traffic-management/#routing-versions\">traffic splitting</a> to direct a small amount of traffic to the new version. Then you can run a <a href=\"https://cloud.google.com/blog/products/devops-sre/canary-analysis-lessons-learned-and-best-practices-from-google-and-waze\">canary analysis</a> on v2 (like check latency and error rate), and finally direct more traffic at the new version until it’s serving all traffic.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c2548d68d472716f3d1bb5154f80c342/95779/canary_diagram.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.26678932842687%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAJnKAACZygHjkaQiAAABpElEQVQoz32TC1OjQBCE+f+/zSpPvWgSDRElJITXEhBNWOa7WR6RK+uOqmFmqN3e7tnG43+PyCzL2Moshv7SQtcNnecWfYfM8ghwrQeQ1gplA0UFphL2KSS5RjFgeDM6szxF94PPPoFya6gryyaE5VZ48iEzYJWl56gaPe1UwyGV/iR3en6CL5WCzZCPB222SBuT7SIuTzGnoORBgZa+cLcaAB2W11p4jeBtL/x+gc27cPZTzK6mMEc4b5BmrTlCziFJXFGtMsp9w/0GVspw9Sq97B7Q6b5fuxBedvAenOl8ZfCcU6QHaENluFB2RS85K1WJlokqiNNxhtqb03gpTvc6gEAZ+jqTKNYTwpTmoAxrt8Qin8qyvtO6IdbNx+eSJPxk9TYQuV26cY2XYu3QHHM3cCE1wwwTzdWHfF+Te50XpIHPJawwquB20XHziM5Q9xWj5J6DFlbt4LKzxaVVe7QjWO+j7mrJNPnS+8moA8OvpRBEw9ydbDvN8F/WmTx5BdZvjvnxaMnNoMY5w6lzdS/5b2P/jAls+ku6zpmbPuaqprV/AHPHVhz9Pr0pAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Diagram\"\n        title=\"Diagram\"\n        src=\"/static/c2548d68d472716f3d1bb5154f80c342/b9e4f/canary_diagram.png\"\n        srcset=\"/static/c2548d68d472716f3d1bb5154f80c342/cf440/canary_diagram.png 148w,\n/static/c2548d68d472716f3d1bb5154f80c342/d2d38/canary_diagram.png 295w,\n/static/c2548d68d472716f3d1bb5154f80c342/b9e4f/canary_diagram.png 590w,\n/static/c2548d68d472716f3d1bb5154f80c342/f9b6a/canary_diagram.png 885w,\n/static/c2548d68d472716f3d1bb5154f80c342/2d849/canary_diagram.png 1180w,\n/static/c2548d68d472716f3d1bb5154f80c342/95779/canary_diagram.png 4348w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.istio.io/v1alpha3\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> VirtualService\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> helloworld\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">hosts</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> helloworld\n  <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">route</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">destination</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> helloworld\n        <span class=\"token key atrule\">subset</span><span class=\"token punctuation\">:</span> v1\n      <span class=\"token key atrule\">weight</span><span class=\"token punctuation\">:</span> <span class=\"token number\">90</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">destination</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> helloworld\n        <span class=\"token key atrule\">subset</span><span class=\"token punctuation\">:</span> v2\n      <span class=\"token key atrule\">weight</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.istio.io/v1alpha3\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> DestinationRule\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> helloworld\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> helloworld\n  <span class=\"token key atrule\">subsets</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> v1\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> v1\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> v2\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> v2</code></pre></div>","frontmatter":{"title":"canary deployment","date":"May 01, 2015"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/canary/","previous":{"fields":{"slug":"/retry/"},"frontmatter":{"title":"retry policy"}},"next":null}}}