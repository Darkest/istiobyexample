{"componentChunkName":"component---src-templates-example-js","path":"/ingress/","webpackCompilationHash":"4c97b8867ce8cc5e8d2c","result":{"data":{"site":{"siteMetadata":{"title":"Istio By Example","author":"Megan O'Keefe"}},"markdownRemark":{"id":"b6f356e4-f529-5811-bf4b-9e2a3643740a","excerpt":"Ingress traffic refers to traffic entering the mesh from outside the cluster. Kubernetes provides ways to handle ingress traffic. With Istio, you can instead…","html":"<p>Ingress traffic refers to traffic entering the mesh from outside the cluster. Kubernetes <a href=\"https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer\">provides</a> <a href=\"https://kubernetes.io/docs/concepts/services-networking/ingress/\">ways</a> to handle ingress traffic. With Istio, you can instead manage ingress traffic with a <strong>Gateway</strong>.</p>\n<p>A <a href=\"https://istio.io/docs/reference/config/networking/v1alpha3/gateway/\">Gateway</a> is a standalone set of Envoy proxies that load-balance inbound traffic. Istio deploys a default <code class=\"language-text\">IngressGateway</code> with a public IP address, which you can configure to expose applications inside your service mesh to the Internet.</p>\n<p>Istio Gateways have two key advantages over traditional Kubernetes Ingress. Because a Gateway is another Envoy proxy, you can use Istio to configure Gateway traffic in the same way you would configure east-west traffic between services (traffic splitting, redirects, retry logic).</p>\n<p>Gateways also forward metrics (request rate, error rate) just like <a href=\"https://istio.io/docs/concepts/what-is-istio/#envoy\">sidecar</a> proxies, allowing you to view Ingress traffic in <a href=\"https://istio.io/docs/tasks/telemetry/kiali/#generating-a-service-graph\">a service graph</a>, and set fine-grained <a href=\"https://landing.google.com/sre/sre-book/chapters/service-level-objectives/\">SLOs</a> on frontend services directly serving clients.</p>\n<p>Let’s see Gateways in action.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bd3ed1fb3d81ea46d223ab1adf06820d/94e46/ingress.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 128.32832832832833%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAADc0lEQVRIx42UyW7bSBCG9YC+TJ7Bj5FLggC5zWUAHwaY5BbkklMGmRiBM3Ecw1asaKG1RDJl7TtX0VyaS/9TTYoiPQ5kkSp0q1n99V/V1V3AIw/nPG51XUelUkX9+hq1moSaJKFcLkPT9K2fsMJjwCiK4rbd7qDZaEDRTWiqAte2UK1UMBr0tn47gemKUZQolLtdvC/e4nIYoK8ydDWgJLVQbo/vRbK3wvF4jMFkce9brVrBRUfB8i7aQgtJJ7G0n1coLAgCHB8f4/Wrv/Dv5xN8OzvD9+Ilzr9+gWL5qE+9ZHEBTGF5y4fg+z5KpRKOjo5weHiI3548wcHBAZ49e47ZZISJGaG7ygHzqrL8ZUCRw7QfhiEURUGr1YLtOPHYVd+GzXIhixS5LtDtpTm7h96ZX8sN8GPoZCmit2DT/5NT4O07jvNLCjHIdveBhRxhEIH5YQz5MXAwN4PN0jyOrKDS9r/8HXj6AvjnE8dKAQyDQ9fIdDJjYyaN3wEmCQgpopLMUOx4cGhspXI4boItiEJ/+w7440+O0SQZDKMs4FSZKEfrcwdKfY6Tngtp5GzT4jgchrmpQ8YAEfZ8ySkU+kwznfoUdnkEuzqG05jFjs71FL68xPK8j/cf+rka4/Bok811rrCpzDYDPFYVGg7WZ12YpEiA3Jsl9L8bCcNmCKuj2I9HyRzX4zQfGVAo0w1sgcLxrtiHXZvA66vw5BWMjy2wiYGA/lvFRGEGxH0g1W68EfmCfnC2abJ10cPtJzne6bzvDiDfFnVs4gbZ3CLpMqWxCyfMfHcoxE6FKbE69OAy7K9Q/LzIgx3ZcCM3NtE3wzU8WPg+1qB6Yna0W6GeAw5YHz+9Vmwtt4k+62HuL6BhgTfSEGVjACNabaU/CuwyGZJbgxqoBJqj7W1KRtbx5XUTM82EQnDspZCeG6+DS/sCU38KPVRRsW5Qk2dU7HQ72z5WxSYtNNtTIT09dovj9Ud8tU7RZnWcaj/xgU6IW5vG3+ff6pgaw/2BHa+NqlMBo82xQgsNJgkv+OUZ2NUUmnSLRbjYP4eyJ6NkX6HhNnDtSmg6TdqENUxmQOuPY9g8mGc5dH8BTM+yeNbcIIAWt8JMrkMJl1CiJVR6VwT04W0VigvmAVBcXQbdeRrdgSYV+f9tnZqetOIgCF8xZ7EkHzMB/gcMqczAUmM0PwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ingress\"\n        title=\"ingress\"\n        src=\"/static/bd3ed1fb3d81ea46d223ab1adf06820d/b9e4f/ingress.png\"\n        srcset=\"/static/bd3ed1fb3d81ea46d223ab1adf06820d/cf440/ingress.png 148w,\n/static/bd3ed1fb3d81ea46d223ab1adf06820d/d2d38/ingress.png 295w,\n/static/bd3ed1fb3d81ea46d223ab1adf06820d/b9e4f/ingress.png 590w,\n/static/bd3ed1fb3d81ea46d223ab1adf06820d/f9b6a/ingress.png 885w,\n/static/bd3ed1fb3d81ea46d223ab1adf06820d/2d849/ingress.png 1180w,\n/static/bd3ed1fb3d81ea46d223ab1adf06820d/94e46/ingress.png 3996w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </a>\n    </span></p>\n<p>Here, the <code class=\"language-text\">hello</code> application runs in a container, inside a Pod. The Pod has an injected Istio sidecar proxy container. A Kubernetes Service called <code class=\"language-text\">hello</code> fronts this Pod. We want to direct inbound traffic from <code class=\"language-text\">hello.com</code> to the <code class=\"language-text\">hello</code> Service.</p>\n<p>First we need a <code class=\"language-text\">Gateway</code> resource, which opens port <code class=\"language-text\">80</code> in the default Istio <code class=\"language-text\">IngressGateway</code>, for all hosts resolving from the <code class=\"language-text\">hello.com</code> domain.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.istio.io/v1alpha3\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Gateway\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> hello<span class=\"token punctuation\">-</span>gateway\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">istio</span><span class=\"token punctuation\">:</span> ingressgateway <span class=\"token comment\"># use the default IngressGateway</span>\n  <span class=\"token key atrule\">servers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> http\n      <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> HTTP\n    <span class=\"token key atrule\">hosts</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"hello.com\"</span></code></pre></div>\n<p>(<strong>Note</strong>: on your own, you’ll still have to resolve the DNS for that host to the Istio <code class=\"language-text\">IngressGateway</code> external IP address.)</p>\n<p>Second, we need a <a href=\"https://istio.io/docs/tasks/traffic-management/ingress/ingress-control/\"><code class=\"language-text\">VirtualService</code></a> to direct traffic from the <code class=\"language-text\">IngressGateway</code> to the <code class=\"language-text\">hello</code> backend Service, running in the <code class=\"language-text\">default</code> namespace on port <code class=\"language-text\">80</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.istio.io/v1alpha3\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> VirtualService\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> frontend<span class=\"token punctuation\">-</span>ingress\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">hosts</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token string\">\"hello.com\"</span>\n  <span class=\"token key atrule\">gateways</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> hello<span class=\"token punctuation\">-</span>gateway\n  <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">route</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">destination</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> hello.default.svc.cluster.local\n        <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></code></pre></div>","frontmatter":{"title":"ingress","date":"May 01, 2015"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/ingress/","previous":null,"next":{"fields":{"slug":"/path-based-routing/"},"frontmatter":{"title":"path-based routing"}}}}}