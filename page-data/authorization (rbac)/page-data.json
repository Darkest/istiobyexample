{"componentChunkName":"component---src-templates-example-js","path":"/authorization (rbac)/","webpackCompilationHash":"4c97b8867ce8cc5e8d2c","result":{"data":{"site":{"siteMetadata":{"title":"Istio By Example","author":"Megan O'Keefe"}},"markdownRemark":{"id":"f5fa4475-d017-53a9-91e6-086444f24bb0","excerpt":"While authentication means verifying the identity of a client,\nAuthorization determines who and what can access other services — or defining permissions. In…","html":"<p>While authentication means verifying the identity of a client,\nAuthorization determines who and what can access other services — or defining permissions.</p>\n<p>In this example, we’ve deployed a website that sells shoes to the <code class=\"language-text\">default</code> Kubernetes namespace. This application includes a <code class=\"language-text\">shoes</code> backend server, a <code class=\"language-text\">users</code> service that records purchase history and user data, and an <code class=\"language-text\">inventory</code> service that periodically loads new shoe inventory into the <code class=\"language-text\">shoes</code> backend.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4728ec40e0fa8a81c959ef33674b4d45/c51b9/rbac.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.86885513637106%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAJnKAACZygHjkaQiAAAB/UlEQVQoz4WSW2+bQBCF8/9/Tp8q9aVSValprdhJcwM7EMdgMDbYYMxtd+frBnKxo6odaSSGmTlzduac8WIiwrE9x6LVSa7SNYsmwK89JuUV08qlMNvXjt7PjhvEGGS/Q/IUs5wjVTmUiRkGYFBGeNpXXGcBSa1Z7yHeC+sSbIqzvtA29IBNhXEu0c4E499B1/LRniuTULH96eOGBU4K043wO7bj5IUhR6RN6GEe3SHWuv8XtSue6oBSlTx0IaPRGJYl5+e3OLkmysFZvwCaQ4HZJph8Y5d0gGyNmd8zqzyCNmKUXzAuLnEPM7IupdAN86eCehwT+DW+BXvM4HbFAKiXPjrykSRgFk2Iv12RXI94qGbEdUyLICfHgrQSskNHZncYF5ah9c3BDDvU4QOSLqFcsfv0mTrIKS98+DWyY6cQ2NwiwGSZPZg9knrea4G0lpoU1i09Y3M66W/RA+qlh97Yprt7mnFEd7fA7FJbu0VmHuK4yHiCnI+QKEBlMdUPy36R0qgpbRvSNF6vhPcd7jaYtsQUOeZgpWPUqS67zrLq7HtXNF++0rpb6vuIqhjTqaUFnQ+A/MN6SZlXDb4rQdFQ3yS0fmi/N6hubQEfhycPOvy7v+n/OK5rjHdrhe9iLr6j4ylKtmhd/J/hB7oDS2VXEa+RGwe8ObT6pOwPV7adVod1XP4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"shoes rbac\"\n        title=\"shoes rbac\"\n        src=\"/static/4728ec40e0fa8a81c959ef33674b4d45/b9e4f/rbac.png\"\n        srcset=\"/static/4728ec40e0fa8a81c959ef33674b4d45/cf440/rbac.png 148w,\n/static/4728ec40e0fa8a81c959ef33674b4d45/d2d38/rbac.png 295w,\n/static/4728ec40e0fa8a81c959ef33674b4d45/b9e4f/rbac.png 590w,\n/static/4728ec40e0fa8a81c959ef33674b4d45/f9b6a/rbac.png 885w,\n/static/4728ec40e0fa8a81c959ef33674b4d45/2d849/rbac.png 1180w,\n/static/4728ec40e0fa8a81c959ef33674b4d45/c51b9/rbac.png 6123w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </a>\n    </span></p>\n<p>We want to authorize <code class=\"language-text\">inventory</code> to be able to <code class=\"language-text\">POST</code> new inventory to <code class=\"language-text\">shoes</code>, but not be able to access <code class=\"language-text\">users</code> at all. Let’s see how to use Istio to do this.</p>\n<p>Istio supports service-to-service authorization (HTTP and TCP) through <strong>role-based access control</strong> (RBAC).</p>\n<p>In this authorization model, you can define abstract Roles, then use a separate resource to bind specific permissions to those Roles.</p>\n<p>RBAC is built into Kubernetes through service accounts.</p>\n<p>Istio works the same way: when a new istio-injected pod is deployed, Istio adds the cert/key pair for the service account that the Pod belongs to.\nForm there, the Envoy sidecar proxies enforce authorization directly.</p>\n<p>We need three Istio resources total to enforce <code class=\"language-text\">shoes</code> authorization for the <code class=\"language-text\">inventory</code> service.</p>\n<ol>\n<li>Enable authorization for the <code class=\"language-text\">default</code> Kubernetes namespace.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"rbac.istio.io/v1alpha1\"</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterRbacConfig\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> default\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">mode</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'ON_WITH_INCLUSION'</span>\n  <span class=\"token key atrule\">inclusion</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">namespaces</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<ol start=\"2\">\n<li>Define a role — the “what”  permissions</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"></code></pre></div>\n<ol start=\"3\">\n<li>Bind the role — who can do what?</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"></code></pre></div>\n<p><code class=\"language-text\">403 Forbidden</code></p>\n<p><a href=\"https://istio.io/docs/concepts/security/#authorization\">https://istio.io/docs/concepts/security/#authorization</a></p>\n<p><a href=\"https://istio.io/docs/reference/config/policy-and-telemetry/templates/authorization/\">https://istio.io/docs/reference/config/policy-and-telemetry/templates/authorization/</a>\n<a href=\"https://istio.io/docs/tasks/security/authz-http/\">https://istio.io/docs/tasks/security/authz-http/</a></p>\n<p><a href=\"https://github.com/GoogleCloudPlatform/istio-samples/tree/77fb1dfb690d28517e410df2911e255d54e3450e/security-intro#authorization\">https://github.com/GoogleCloudPlatform/istio-samples/tree/77fb1dfb690d28517e410df2911e255d54e3450e/security-intro#authorization</a></p>\n<p>This example covered service-level access control, but Istio <a href=\"https://istio.io/docs/tasks/security/authz-http/#enforcing-namespace-level-access-control\">also supports</a> access control across namespaces.</p>","frontmatter":{"title":"authorization (rbac)","date":"May 01, 2015"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/authorization (rbac)/","previous":null,"next":{"fields":{"slug":"/traffic-mirroring/"},"frontmatter":{"title":"traffic mirroring"}}}}}