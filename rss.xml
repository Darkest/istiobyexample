<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Istio By Example]]></title><description><![CDATA[Service Mesh Made Simple]]></description><link>https://istiobyexample.dev/</link><generator>RSS for Node</generator><lastBuildDate>Fri, 23 Aug 2019 15:24:34 GMT</lastBuildDate><item><title><![CDATA[canary deployment]]></title><description><![CDATA[A canary deployment is a strategy for safely rolling out a new version of a service. With Istio, you can use percentage-based traffic…]]></description><link>https://istiobyexample.dev//canary/</link><guid isPermaLink="false">https://istiobyexample.dev//canary/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;A canary deployment is a strategy for safely rolling out a new version of a service. With Istio, you can use percentage-based &lt;a href=&quot;https://istio.io/docs/concepts/traffic-management/#routing-versions&quot;&gt;traffic splitting&lt;/a&gt; to direct a small amount of traffic to the new version. Then you can run a &lt;a href=&quot;https://cloud.google.com/blog/products/devops-sre/canary-analysis-lessons-learned-and-best-practices-from-google-and-waze&quot;&gt;canary analysis&lt;/a&gt; on v2 (like check latency and error rate), and finally direct more traffic at the new version until it’s serving all traffic.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c2548d68d472716f3d1bb5154f80c342/95779/canary_diagram.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 55.26678932842687%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAJnKAACZygHjkaQiAAABpElEQVQoz32TC1OjQBCE+f+/zSpPvWgSDRElJITXEhBNWOa7WR6RK+uOqmFmqN3e7tnG43+PyCzL2Moshv7SQtcNnecWfYfM8ghwrQeQ1gplA0UFphL2KSS5RjFgeDM6szxF94PPPoFya6gryyaE5VZ48iEzYJWl56gaPe1UwyGV/iR3en6CL5WCzZCPB222SBuT7SIuTzGnoORBgZa+cLcaAB2W11p4jeBtL/x+gc27cPZTzK6mMEc4b5BmrTlCziFJXFGtMsp9w/0GVspw9Sq97B7Q6b5fuxBedvAenOl8ZfCcU6QHaENluFB2RS85K1WJlokqiNNxhtqb03gpTvc6gEAZ+jqTKNYTwpTmoAxrt8Qin8qyvtO6IdbNx+eSJPxk9TYQuV26cY2XYu3QHHM3cCE1wwwTzdWHfF+Te50XpIHPJawwquB20XHziM5Q9xWj5J6DFlbt4LKzxaVVe7QjWO+j7mrJNPnS+8moA8OvpRBEw9ydbDvN8F/WmTx5BdZvjvnxaMnNoMY5w6lzdS/5b2P/jAls+ku6zpmbPuaqprV/AHPHVhz9Pr0pAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Diagram&quot;
        title=&quot;Diagram&quot;
        src=&quot;/static/c2548d68d472716f3d1bb5154f80c342/b9e4f/canary_diagram.png&quot;
        srcset=&quot;/static/c2548d68d472716f3d1bb5154f80c342/cf440/canary_diagram.png 148w,
/static/c2548d68d472716f3d1bb5154f80c342/d2d38/canary_diagram.png 295w,
/static/c2548d68d472716f3d1bb5154f80c342/b9e4f/canary_diagram.png 590w,
/static/c2548d68d472716f3d1bb5154f80c342/f9b6a/canary_diagram.png 885w,
/static/c2548d68d472716f3d1bb5154f80c342/2d849/canary_diagram.png 1180w,
/static/c2548d68d472716f3d1bb5154f80c342/95779/canary_diagram.png 4348w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; VirtualService
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; helloworld
  &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
        &lt;span class=&quot;token key atrule&quot;&gt;subset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
      &lt;span class=&quot;token key atrule&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;90&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
        &lt;span class=&quot;token key atrule&quot;&gt;subset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v2
      &lt;span class=&quot;token key atrule&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; DestinationRule
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
  &lt;span class=&quot;token key atrule&quot;&gt;subsets&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
    &lt;span class=&quot;token key atrule&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v2
    &lt;span class=&quot;token key atrule&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[retry policy]]></title><description><![CDATA[Microservices architectures are distributed. This means more requests on the network, increasing the chance of transient failures like…]]></description><link>https://istiobyexample.dev//retry/</link><guid isPermaLink="false">https://istiobyexample.dev//retry/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;Microservices architectures are distributed. This means more requests on the network, increasing the chance of transient failures like network congestion.&lt;/p&gt;
&lt;p&gt;Adding retry policies for requests helps build resiliency in a services architecture. Often, this retry logic is &lt;a href=&quot;https://upgear.io/blog/simple-golang-retry-function/&quot;&gt;built into source code&lt;/a&gt;. But with Istio, you can define retry policies &lt;a href=&quot;https://istio.io/docs/concepts/traffic-management/#set-number-and-timeouts-for-retries&quot;&gt;with a traffic rule&lt;/a&gt;, offloading this logic to your services’ &lt;a href=&quot;https://istio.io/docs/concepts/what-is-istio/#architecture&quot;&gt;sidecar proxies&lt;/a&gt;. This can help you standardize around the same policies across many services, protocols, and programming languages.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d04b1ed50b6173e601a8aeca559a7d52/8ddd4/retry.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 46.16132167152575%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAJnKAACZygHjkaQiAAABZUlEQVQoz32S3W6bQBCFef/nSq9ykTZpqmCTpI6htvkRGMdml92drwMEo6pRVhrtMDp7mDNnIr44IjLGUmD5ls/fRCJBQe4aQSwhWM17RGbSmWjOB6ydsNe3A94TuVDQh53GHhdyPA2BVvNSwe9La1eynp4DXhrF1oot9D4w80Q2vGoh00KFYYOvz5iHWgkcna3pOmhPgg+TxoDFnQouNzm2zmkuK94vKb2kE6HxCcnLT9ZxipE9XZxh1jV2k5NVLesEfsXC762QFxBvHH++raHqaX488vh0xyrefnSYDYTPtOct1nTa0w6T5HR3FX2hsjmyTWGfi/5U+P6AdtTTrt4wtyXn5IVdeU+axRj/OktWMnnChhUmJDivZCrJMcywUbnaTC0cCqGsBtFGR1TiipOad9HJNlrTeUo7EQ7OTE5/hFKNMbomn5gSVN5gyHE0xoXjGF6OI2n0//L9u2PL2iz5V3v4F0PYvBQdYfR+AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Diagram&quot;
        title=&quot;Diagram&quot;
        src=&quot;/static/d04b1ed50b6173e601a8aeca559a7d52/b9e4f/retry.png&quot;
        srcset=&quot;/static/d04b1ed50b6173e601a8aeca559a7d52/cf440/retry.png 148w,
/static/d04b1ed50b6173e601a8aeca559a7d52/d2d38/retry.png 295w,
/static/d04b1ed50b6173e601a8aeca559a7d52/b9e4f/retry.png 590w,
/static/d04b1ed50b6173e601a8aeca559a7d52/f9b6a/retry.png 885w,
/static/d04b1ed50b6173e601a8aeca559a7d52/2d849/retry.png 1180w,
/static/d04b1ed50b6173e601a8aeca559a7d52/8ddd4/retry.png 5145w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In this example, all inbound requests to the &lt;code class=&quot;language-text&quot;&gt;helloworld&lt;/code&gt; service try 5 times, and an attempt is marked as failed if it takes longer than 2 seconds to complete.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; DestinationRule
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
  &lt;span class=&quot;token key atrule&quot;&gt;subsets&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
    &lt;span class=&quot;token key atrule&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; VirtualService
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; helloworld
  &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; helloworld
        &lt;span class=&quot;token key atrule&quot;&gt;subset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
    &lt;span class=&quot;token key atrule&quot;&gt;retries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;attempts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;perTryTimeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 2s&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[mutual tls]]></title><description><![CDATA[A microservices architecture means more requests on the network, and more opportunities for malicious parties to intercept traffic. Mutual…]]></description><link>https://istiobyexample.dev//mtls/</link><guid isPermaLink="false">https://istiobyexample.dev//mtls/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;A microservices architecture means more requests on the network, and more opportunities for malicious parties to intercept traffic. &lt;a href=&quot;https://en.wikipedia.org/wiki/Mutual_authentication&quot;&gt;Mutual TLS&lt;/a&gt; (mTLS) authentication is a way to encrypt services traffic using &lt;a href=&quot;https://www.internetsociety.org/deploy360/tls/basics/&quot;&gt;certificates&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;With Istio, you can automate the enforcement of mTLS across all services. Below, we enable mTLS for the entire mesh. Two pods in the cluster, &lt;code class=&quot;language-text&quot;&gt;client&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt;, are shown establishing a secure connection with the mTLS policy in place.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4023fdf6c75d10290a6dd65f63b7471e/3e8e9/mtls.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 34.11169170476813%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAJnKAACZygHjkaQiAAABQElEQVQoz4WRXU/jMBBF8/9/Eu+LQLuiBR7QlhIKTQtNGyf+jB0nPrjhCQnBSFdjWbrHcz0Fv1T65jxNE0MYGYaRGM+aZqWUKJwbaBpL1/WfXUW6g6EVnt42meJIYUfqV+DumcI7rYxI7bMG2i5kr+N4NDOjEMKx3bZUVUf5LPCyxv6tUKsKKR7B/iOZG5K9B3NN1Eu6astYdvkhzamuOTU9+51kl1W0rWO9PrFaHXnN0EksCIsd/cMC061BX5H0NcmX0D8ymUvU8oLhSRDKOzZPS8pSsdk081AzcL+XSNlT1xo/QDharErIepkhdxlW5eT/58gxNIh3g1vnNC7RtB6tPIeD5u1NUYzjhDEBlS+1zl06pPEoHYnyT458O8OSfyFFMS/F5n+X9uzps8fP3vNA3keKX7ec4pctnzf5U30ADZwaIEs3XGIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Diagram&quot;
        title=&quot;Diagram&quot;
        src=&quot;/static/4023fdf6c75d10290a6dd65f63b7471e/b9e4f/mtls.png&quot;
        srcset=&quot;/static/4023fdf6c75d10290a6dd65f63b7471e/cf440/mtls.png 148w,
/static/4023fdf6c75d10290a6dd65f63b7471e/d2d38/mtls.png 295w,
/static/4023fdf6c75d10290a6dd65f63b7471e/b9e4f/mtls.png 590w,
/static/4023fdf6c75d10290a6dd65f63b7471e/f9b6a/mtls.png 885w,
/static/4023fdf6c75d10290a6dd65f63b7471e/2d849/mtls.png 1180w,
/static/4023fdf6c75d10290a6dd65f63b7471e/3e8e9/mtls.png 6124w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; authentication.istio.io/v1alpha1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; MeshPolicy
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; default
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;peers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;mtls&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; STRICT&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; DestinationRule
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; default
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; istio&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;system
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; *.local
  &lt;span class=&quot;token key atrule&quot;&gt;trafficPolicy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;tls&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ISTIO_MUTUAL&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here, a &lt;code class=&quot;language-text&quot;&gt;MeshPolicy&lt;/code&gt; enforces TLS for all services &lt;em&gt;receiving&lt;/em&gt; requests (server-side), and a &lt;code class=&quot;language-text&quot;&gt;DestinationRule&lt;/code&gt; enforces TLS for all services &lt;em&gt;sending&lt;/em&gt; requests (client-side), resulting in mutual (“both”) TLS.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Authentication Flow:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;client&lt;/code&gt; application container sends a plain-text HTTP request to &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;client&lt;/code&gt; proxy container intercepts the outbound request.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;client&lt;/code&gt; proxy performs a TLS &lt;a href=&quot;https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_7.1.0/com.ibm.mq.doc/sy10660_.htm&quot;&gt;handshake&lt;/a&gt; with the server-side proxy. This handshake includes an exchange of certificates. These certs are pre-loaded into the proxy containers by Istio.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;client&lt;/code&gt; proxy performs a &lt;a href=&quot;https://istio.io/docs/concepts/security/#secure-naming&quot;&gt;secure naming&lt;/a&gt; check on the server’s certificate, verifying that an authorized identity is running the &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;client&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt; establish a mutual TLS connection, and the &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt; proxy forwards the request to the &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt; application container.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Learn more&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/docs/concepts/security/#authentication&quot;&gt;Istio Docs - Authentication&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/GoogleCloudPlatform/istio-samples/tree/77fb1dfb690d28517e410df2911e255d54e3450e/security-intro#authentication&quot;&gt;Samples: Authentication&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/docs/tasks/security/authn-policy/&quot;&gt;Task - Authentication Policies&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/docs/tasks/security/mutual-tls/&quot;&gt;Task - Mutual TLS Deep-Dive&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/faq/security/#enabling-disabling-mtls&quot;&gt;FAQ - mTLS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[path-based routing]]></title><description><![CDATA[Istio and Envoy work at the Application traffic layer (L7), allowing you to direct and load-balance traffic based on attributes like HTTP…]]></description><link>https://istiobyexample.dev//path-based-routing/</link><guid isPermaLink="false">https://istiobyexample.dev//path-based-routing/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;Istio and &lt;a href=&quot;https://istio.io/docs/concepts/what-is-istio/#envoy&quot;&gt;Envoy&lt;/a&gt; work at the Application traffic layer (L7), allowing you to direct and load-balance traffic based on attributes like HTTP headers. This example shows how to direct traffic &lt;a href=&quot;https://istio.io/docs/concepts/traffic-management/#match-request-uri&quot;&gt;based on the request URI&lt;/a&gt; path.&lt;/p&gt;
&lt;p&gt;In this example, &lt;code class=&quot;language-text&quot;&gt;myapp&lt;/code&gt; is the server backend for a website, used by the &lt;code class=&quot;language-text&quot;&gt;frontend&lt;/code&gt;. An engineering team has implemented a new user authentication service, &lt;code class=&quot;language-text&quot;&gt;auth&lt;/code&gt;, which now operates as a separate service.&lt;/p&gt;
&lt;p&gt;Using an Istio &lt;a href=&quot;https://istio.io/docs/reference/config/networking/v1alpha3/virtual-service/#HTTPMatchRequest&quot;&gt;match rule&lt;/a&gt;, we redirect any request with the &lt;code class=&quot;language-text&quot;&gt;/login&lt;/code&gt; prefix to the new &lt;code class=&quot;language-text&quot;&gt;auth&lt;/code&gt; service, and direct all other &lt;code class=&quot;language-text&quot;&gt;myapp&lt;/code&gt; requests to the existing backend.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/549fa78eb8e1f4245156becb55891d6c/4b018/urimatch.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 55.709009153685564%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAJnKAACZygHjkaQiAAABwElEQVQoz32TCVPbMBCF8///VWc6HShlSsnVAgnEIbaxY/mWLUvy1w2loVyVZ2e9Op7evl1N+GCM43j0b8xbRp7MO5k7mH9cm7x74Gj+3cucK+i3ASaLMe2KvrqhL3/hhorJ+/RehrZXDDrE2xZrEprdCf1C0c0jOrWQtXtMvZZ9GZPa1URDSDxEZC4jN4rMy2Yvh9sdOp/SpifiLzFNICz2dLEw+pmhpyE6vhCg5BnwADbrpgQ24K5Yoc9Cyr0iUKd06Sn0AaNrhLV7Ttkqmd5goh1GrzGSsqmu/qQc25gv9Wdmbs5yeQ7BQL2MuMkDvi5i5hvRaxjxIoP3/qkoDicFsaMVPeVfYu/do1aTQ6rn7TeWZsm6uKa7fCAPYyr5us4zv0v59GPL9DY9Mixaw15p8saQlpqk0MSqRfeWSeMbEpuwtyn5mFNIBZV47fQRoB8cm4eSTVyijRWwluZ7jN6WLLaK26jgcp2iqu5Vlce3vejH8QXwSoBPzzb4m5xqljC7euA6zLlYJeR1//8+/HvLyxiirKEQsGqTE6Q14b7h6l6h6u6DPnzF8t9XcxitaKW0oewHsrJ71C+TdAfr+Q3Af1DuJHpbcwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;URI Match with Istio&quot;
        title=&quot;URI Match with Istio&quot;
        src=&quot;/static/549fa78eb8e1f4245156becb55891d6c/b9e4f/urimatch.png&quot;
        srcset=&quot;/static/549fa78eb8e1f4245156becb55891d6c/cf440/urimatch.png 148w,
/static/549fa78eb8e1f4245156becb55891d6c/d2d38/urimatch.png 295w,
/static/549fa78eb8e1f4245156becb55891d6c/b9e4f/urimatch.png 590w,
/static/549fa78eb8e1f4245156becb55891d6c/f9b6a/urimatch.png 885w,
/static/549fa78eb8e1f4245156becb55891d6c/2d849/urimatch.png 1180w,
/static/549fa78eb8e1f4245156becb55891d6c/4b018/urimatch.png 6227w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; VirtualService
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; auth&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;redirect
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; myapp
  &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/login&quot;&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; auth
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; myapp&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[ingress]]></title><description><![CDATA[Ingress traffic refers to traffic entering the mesh from outside the cluster. Kubernetes provides ways to handle ingress traffic. With Istio…]]></description><link>https://istiobyexample.dev//ingress/</link><guid isPermaLink="false">https://istiobyexample.dev//ingress/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;Ingress traffic refers to traffic entering the mesh from outside the cluster. Kubernetes &lt;a href=&quot;https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer&quot;&gt;provides&lt;/a&gt; &lt;a href=&quot;https://kubernetes.io/docs/concepts/services-networking/ingress/&quot;&gt;ways&lt;/a&gt; to handle ingress traffic. With Istio, you can instead manage ingress traffic with a &lt;strong&gt;Gateway&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;A &lt;a href=&quot;https://istio.io/docs/reference/config/networking/v1alpha3/gateway/&quot;&gt;Gateway&lt;/a&gt; is a standalone set of Envoy proxies that load-balance inbound traffic. Istio deploys a default &lt;code class=&quot;language-text&quot;&gt;IngressGateway&lt;/code&gt; with a public IP address, which you can configure to expose applications inside your service mesh to the Internet.&lt;/p&gt;
&lt;p&gt;Istio Gateways have two key advantages over traditional Kubernetes Ingress. Because a Gateway is another Envoy proxy, you can use Istio to configure Gateway traffic in the same way you would configure east-west traffic between services (traffic splitting, redirects, retry logic).&lt;/p&gt;
&lt;p&gt;Gateways also forward metrics (request rate, error rate) just like &lt;a href=&quot;https://istio.io/docs/concepts/what-is-istio/#envoy&quot;&gt;sidecar&lt;/a&gt; proxies, allowing you to view Ingress traffic in &lt;a href=&quot;https://istio.io/docs/tasks/telemetry/kiali/#generating-a-service-graph&quot;&gt;a service graph&lt;/a&gt;, and set fine-grained &lt;a href=&quot;https://landing.google.com/sre/sre-book/chapters/service-level-objectives/&quot;&gt;SLOs&lt;/a&gt; on frontend services directly serving clients.&lt;/p&gt;
&lt;p&gt;Let’s see Gateways in action.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/bd3ed1fb3d81ea46d223ab1adf06820d/94e46/ingress.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 128.32832832832833%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAADc0lEQVRIx42UyW7bSBCG9YC+TJ7Bj5FLggC5zWUAHwaY5BbkklMGmRiBM3Ecw1asaKG1RDJl7TtX0VyaS/9TTYoiPQ5kkSp0q1n99V/V1V3AIw/nPG51XUelUkX9+hq1moSaJKFcLkPT9K2fsMJjwCiK4rbd7qDZaEDRTWiqAte2UK1UMBr0tn47gemKUZQolLtdvC/e4nIYoK8ydDWgJLVQbo/vRbK3wvF4jMFkce9brVrBRUfB8i7aQgtJJ7G0n1coLAgCHB8f4/Wrv/Dv5xN8OzvD9+Ilzr9+gWL5qE+9ZHEBTGF5y4fg+z5KpRKOjo5weHiI3548wcHBAZ49e47ZZISJGaG7ygHzqrL8ZUCRw7QfhiEURUGr1YLtOPHYVd+GzXIhixS5LtDtpTm7h96ZX8sN8GPoZCmit2DT/5NT4O07jvNLCjHIdveBhRxhEIH5YQz5MXAwN4PN0jyOrKDS9r/8HXj6AvjnE8dKAQyDQ9fIdDJjYyaN3wEmCQgpopLMUOx4cGhspXI4boItiEJ/+w7440+O0SQZDKMs4FSZKEfrcwdKfY6Tngtp5GzT4jgchrmpQ8YAEfZ8ySkU+kwznfoUdnkEuzqG05jFjs71FL68xPK8j/cf+rka4/Bok811rrCpzDYDPFYVGg7WZ12YpEiA3Jsl9L8bCcNmCKuj2I9HyRzX4zQfGVAo0w1sgcLxrtiHXZvA66vw5BWMjy2wiYGA/lvFRGEGxH0g1W68EfmCfnC2abJ10cPtJzne6bzvDiDfFnVs4gbZ3CLpMqWxCyfMfHcoxE6FKbE69OAy7K9Q/LzIgx3ZcCM3NtE3wzU8WPg+1qB6Yna0W6GeAw5YHz+9Vmwtt4k+62HuL6BhgTfSEGVjACNabaU/CuwyGZJbgxqoBJqj7W1KRtbx5XUTM82EQnDspZCeG6+DS/sCU38KPVRRsW5Qk2dU7HQ72z5WxSYtNNtTIT09dovj9Ud8tU7RZnWcaj/xgU6IW5vG3+ff6pgaw/2BHa+NqlMBo82xQgsNJgkv+OUZ2NUUmnSLRbjYP4eyJ6NkX6HhNnDtSmg6TdqENUxmQOuPY9g8mGc5dH8BTM+yeNbcIIAWt8JMrkMJl1CiJVR6VwT04W0VigvmAVBcXQbdeRrdgSYV+f9tnZqetOIgCF8xZ7EkHzMB/gcMqczAUmM0PwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;ingress&quot;
        title=&quot;ingress&quot;
        src=&quot;/static/bd3ed1fb3d81ea46d223ab1adf06820d/b9e4f/ingress.png&quot;
        srcset=&quot;/static/bd3ed1fb3d81ea46d223ab1adf06820d/cf440/ingress.png 148w,
/static/bd3ed1fb3d81ea46d223ab1adf06820d/d2d38/ingress.png 295w,
/static/bd3ed1fb3d81ea46d223ab1adf06820d/b9e4f/ingress.png 590w,
/static/bd3ed1fb3d81ea46d223ab1adf06820d/f9b6a/ingress.png 885w,
/static/bd3ed1fb3d81ea46d223ab1adf06820d/2d849/ingress.png 1180w,
/static/bd3ed1fb3d81ea46d223ab1adf06820d/94e46/ingress.png 3996w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here, the &lt;code class=&quot;language-text&quot;&gt;hello&lt;/code&gt; application runs in a container, inside a Pod. The Pod has an injected Istio sidecar proxy container. A Kubernetes Service called &lt;code class=&quot;language-text&quot;&gt;hello&lt;/code&gt; fronts this Pod. We want to direct inbound traffic from &lt;code class=&quot;language-text&quot;&gt;hello.com&lt;/code&gt; to the &lt;code class=&quot;language-text&quot;&gt;hello&lt;/code&gt; Service.&lt;/p&gt;
&lt;p&gt;First we need a &lt;code class=&quot;language-text&quot;&gt;Gateway&lt;/code&gt; resource, which opens port &lt;code class=&quot;language-text&quot;&gt;80&lt;/code&gt; in the default Istio &lt;code class=&quot;language-text&quot;&gt;IngressGateway&lt;/code&gt;, for all hosts resolving from the &lt;code class=&quot;language-text&quot;&gt;hello.com&lt;/code&gt; domain.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Gateway
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; hello&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;gateway
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;istio&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ingressgateway &lt;span class=&quot;token comment&quot;&gt;# use the default IngressGateway&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;servers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; http
      &lt;span class=&quot;token key atrule&quot;&gt;protocol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; HTTP
    &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hello.com&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(&lt;strong&gt;Note&lt;/strong&gt;: on your own, you’ll still have to resolve the DNS for that host to the Istio &lt;code class=&quot;language-text&quot;&gt;IngressGateway&lt;/code&gt; external IP address.)&lt;/p&gt;
&lt;p&gt;Second, we need a &lt;a href=&quot;https://istio.io/docs/tasks/traffic-management/ingress/ingress-control/&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;VirtualService&lt;/code&gt;&lt;/a&gt; to direct traffic from the &lt;code class=&quot;language-text&quot;&gt;IngressGateway&lt;/code&gt; to the &lt;code class=&quot;language-text&quot;&gt;hello&lt;/code&gt; backend Service, running in the &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; namespace on port &lt;code class=&quot;language-text&quot;&gt;80&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; VirtualService
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; frontend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;ingress
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hello.com&quot;&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;gateways&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; hello&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;gateway
  &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; hello.default.svc.cluster.local
        &lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[load balancing]]></title><description><![CDATA[Kubernetes supports load balancing for inbound traffic. But what about Kubernetes services inside the cluster? When in-cluster services…]]></description><link>https://istiobyexample.dev//load-balancing/</link><guid isPermaLink="false">https://istiobyexample.dev//load-balancing/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;Kubernetes supports load balancing for &lt;a href=&quot;https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer&quot;&gt;inbound&lt;/a&gt; traffic. But what about Kubernetes services inside the cluster?&lt;/p&gt;
&lt;p&gt;When in-cluster services &lt;a href=&quot;https://kubernetes.io/docs/concepts/services-networking/#proxy-mode-iptables&quot;&gt;communicate&lt;/a&gt;, a load balancer called kube-proxy &lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/concepts/network-overview#services&quot;&gt;forwards&lt;/a&gt; requests to service pods at random. You can use Istio to add more complex load balancing methods, enabled by Envoy.&lt;/p&gt;
&lt;p&gt;Envoy supports multiple load balancing methods, including &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/load_balancing/load_balancers#random&quot;&gt;random&lt;/a&gt;, &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/load_balancing/load_balancers#weighted-round-robin&quot;&gt;round-robin&lt;/a&gt;, and &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/load_balancing/load_balancers#weighted-least-request&quot;&gt;least request&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let’s see how to use Istio to add &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/load_balancing/load_balancers#weighted-least-request&quot;&gt;&lt;strong&gt;least request&lt;/strong&gt;&lt;/a&gt; load balancing for a service called &lt;code class=&quot;language-text&quot;&gt;payments&lt;/code&gt;, which processes all transactions for a web &lt;code class=&quot;language-text&quot;&gt;frontend&lt;/code&gt;. The payments service is backed by three pods.&lt;/p&gt;
&lt;p&gt;In this least request algorithm, the client-side Envoy will first choose two instances at random. Then, it will forward the request to the instance with the fewest number of active requests, to help ensure even load balancing across all instances.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c3a984ef8540731916a890e0f734b7f0/b0ee1/least-requests.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 77.37630208333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAJnKAACZygHjkaQiAAACbklEQVQ4y3WUiU7bQBCG8/7vVKlSaUEQ0hAackAOx7l837fXXydO08ZAVxrtei1/+8/Mv+7RGQ1N05xXTdOJ6xGrgOd6wKHa8lZNcGuDefXSvuv9D/Ae0jQleaFRV2vcuM/a+sohvEP3b1l531m7X8iy5RnYfvwOcIGopmjXde2T50vZO2C7Q7Jng1z3eNsHaMeU4esCJ3ik1wVUKJW2keVTUbQQUHhdERkZ1vaBbOUTzk1G0yO6nfG02AhwIAqVQgioKqLINZLknjydCXBCreJ35Tg9RVjuLf54T6gZrAwHw0uY6RMBPtFTvo0KPVQgcxxSO67MjhxyUa2uoG3yeNGIQ/ATK3rCcAdszT5HR4SUIb16+0Zt7VCWTqGZpBOLynT/Znit7tIoKywx1xa+F7M2PZYHVyIgzioBbubUho46LsmmAt2FpC+y19gCqK/q+6/zthGQjg9EK4eVgMKk4NfKxglTAZ5ggYPyDGovIn+VlP2AsthRFGvKci8lzv5Az3BTd0hfDcKZwc1QZy0HjJbmGdhkCSry2igTjSKdUERTgekC21FVtqxXLfzScTdSok4y8TKOfoIpTdmYKUFcd22Tl0uStE+UfCPNRuK7uai6+DBsfZimN9KAPgtngGbfszHuJO07dtYPymp/Mfa5kyf/pdmzOH4sALdj8qoyZH8qqsdij3uiidTccdh7PpYfs9jPccN+9+pd2+Sz66jqk9pQjP1IMncJX00exjsWh5iH2Qk4Oqf8Edp82Dv/ONrCSJf70mWbeOEx1XySHN52S2x/3AV+ButGmzxWcMfx8IzrT9HMIbPNgOX+K0mm8Rsho4AHrF7EZAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;load balancing&quot;
        title=&quot;load balancing&quot;
        src=&quot;/static/c3a984ef8540731916a890e0f734b7f0/b9e4f/least-requests.png&quot;
        srcset=&quot;/static/c3a984ef8540731916a890e0f734b7f0/cf440/least-requests.png 148w,
/static/c3a984ef8540731916a890e0f734b7f0/d2d38/least-requests.png 295w,
/static/c3a984ef8540731916a890e0f734b7f0/b9e4f/least-requests.png 590w,
/static/c3a984ef8540731916a890e0f734b7f0/f9b6a/least-requests.png 885w,
/static/c3a984ef8540731916a890e0f734b7f0/2d849/least-requests.png 1180w,
/static/c3a984ef8540731916a890e0f734b7f0/b0ee1/least-requests.png 6144w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;To enable this functionality, we create an Istio &lt;a href=&quot;https://istio.io/docs/reference/config/networking/v1alpha3/destination-rule/&quot;&gt;DestinationRule&lt;/a&gt; with a &lt;a href=&quot;https://istio.io/docs/reference/config/networking/v1alpha3/destination-rule/#LoadBalancerSettings-SimpleLB&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;LEAST_CONN&lt;/code&gt;&lt;/a&gt; load balancer:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; DestinationRule
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; payments&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;load&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;balancer
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; payments.prod.svc.cluster.local
  &lt;span class=&quot;token key atrule&quot;&gt;trafficPolicy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;loadBalancer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;simple&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; LEAST_CONN&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Check out the &lt;a href=&quot;https://istio.io/docs/concepts/traffic-management/#load-balancing-3-subsets&quot;&gt;Istio docs&lt;/a&gt; to see how to add multiple load balancing methods for a single host.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[jwt]]></title><description><![CDATA[A JSON Web Token (JWT) is a type of authentication token used to identify a user to a server application. JWTs contain information about the…]]></description><link>https://istiobyexample.dev//jwt/</link><guid isPermaLink="false">https://istiobyexample.dev//jwt/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;A &lt;a href=&quot;https://jwt.io/introduction/&quot;&gt;JSON Web Token&lt;/a&gt; (JWT) is a type of authentication token used to identify a user to a server application. JWTs contain information about the client caller, and can be used as part of a client session architecture. A &lt;a href=&quot;https://auth0.com/docs/jwks&quot;&gt;JSON Web Key Set&lt;/a&gt; (JWKS) contains the cryptographic keys used to verify incoming JWTs.&lt;/p&gt;
&lt;p&gt;You can use Istio’s &lt;a href=&quot;https://istio.io/docs/reference/config/istio.authentication.v1alpha1/#Jwt&quot;&gt;Authentication API&lt;/a&gt; to &lt;a href=&quot;https://istio.io/docs/concepts/security/#origin-authentication&quot;&gt;configure JWT policies&lt;/a&gt; for your services.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/29ed7235f86b47337cbda24bc10ac9bd/700db/jwt.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 49.64447317388494%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAJnKAACZygHjkaQiAAABfElEQVQoz32S207bQBRF/e2ID6hEqFSpP1BV4qGv5amioik8VFRUuSAlLokdZ4gdO75hz5zFYAdwCulIW+cizd7n5vCfJyINun4Ty27chfNWsiF4/MUL2b9CW+9VEc6+ytgRENJSNzCmJalrsQBtrdYtnisMw5BFEKACxTqKn7UbbIu4uas5HaZcL0qKTNisrUhkSDeQWBsqQ5ZYwqqo6Y9/cJJ84oM64ufNOVQxUvlIHSGmtHQFcZLgX86IVMYmh9JVVEOXcJ4TzA3ziSaYaRxdaS5Gfb6sP/MxeM/Z4CvkEyS/RkoXuZ/bvjz09Jz6doWe3FJEY/Lf39DukKD/i5mrmQ40/l9L6Ps+x71jDg8O6b3rMRqNd1vezlVnFdmfBZUXkqbW9wryYchqlnIXCN5UozyDk9hWlsslSqlmlk/bEzHtALubt900C6kgW03JwwFZnBLbb+uV4b6U11t+6/a6p9IaK1Zcwea7TSQ7J7T/DveRNvFT8dKxLR4AvPcEvB1yW9UAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;jwt&quot;
        title=&quot;jwt&quot;
        src=&quot;/static/29ed7235f86b47337cbda24bc10ac9bd/b9e4f/jwt.png&quot;
        srcset=&quot;/static/29ed7235f86b47337cbda24bc10ac9bd/cf440/jwt.png 148w,
/static/29ed7235f86b47337cbda24bc10ac9bd/d2d38/jwt.png 295w,
/static/29ed7235f86b47337cbda24bc10ac9bd/b9e4f/jwt.png 590w,
/static/29ed7235f86b47337cbda24bc10ac9bd/f9b6a/jwt.png 885w,
/static/29ed7235f86b47337cbda24bc10ac9bd/2d849/jwt.png 1180w,
/static/29ed7235f86b47337cbda24bc10ac9bd/700db/jwt.png 6188w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In this example, we require a JWT for all routes in the &lt;code class=&quot;language-text&quot;&gt;frontend&lt;/code&gt; service except for the home page (&lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt;) and the pod health check (&lt;code class=&quot;language-text&quot;&gt;/_healthz&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;In the Istio policy, we specify the path to a test public key (&lt;code class=&quot;language-text&quot;&gt;jwksUri&lt;/code&gt;), which will be mounted into the frontend’s sidecar proxy. All unauthenticated requests will receive a &lt;code class=&quot;language-text&quot;&gt;401 - Unauthorized&lt;/code&gt; status from Envoy.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;authentication.istio.io/v1alpha1&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Policy&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;frontend-jwt&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; frontend
  &lt;span class=&quot;token key atrule&quot;&gt;origins&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;jwt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;issuer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;testing@secure.istio.io&quot;&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;jwksUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://raw.githubusercontent.com/istio/istio/release-1.2/security/tools/jwt/samples/jwks.json&quot;&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;trigger_rules&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;excluded_paths&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;exact&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /_healthz
        &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;exact&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /
  &lt;span class=&quot;token key atrule&quot;&gt;principalBinding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; USE_ORIGIN&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To learn more and try interactive examples, see the &lt;a href=&quot;https://istio.io/docs/tasks/security/authn-policy/#end-user-authentication&quot;&gt;Istio docs&lt;/a&gt; and the &lt;a href=&quot;https://github.com/GoogleCloudPlatform/istio-samples/tree/master/security-intro#add-end-user-jwt-authentication&quot;&gt;istio-samples repo&lt;/a&gt;.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[traffic mirroring]]></title><description><![CDATA[Testing a service in production is important to help ensure reliability. Sending live production traffic to a new version of a service can…]]></description><link>https://istiobyexample.dev//traffic-mirroring/</link><guid isPermaLink="false">https://istiobyexample.dev//traffic-mirroring/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;Testing a service in production is important to help ensure reliability. Sending live production traffic to a new version of a service can help reveal bugs that went untested during continuous integration and functional tests.&lt;/p&gt;
&lt;p&gt;Using Istio, you can use &lt;a href=&quot;https://istio.io/docs/tasks/traffic-management/mirroring/&quot;&gt;&lt;strong&gt;traffic mirroring&lt;/strong&gt;&lt;/a&gt; to duplicate traffic to another service. You can incorporate a traffic mirroring rule as part of a &lt;a href=&quot;https://istiobyexample.dev/canary&quot;&gt;canary deployment&lt;/a&gt; pipeline, allowing you to analyze a service’s behavior before sending live traffic to it.&lt;/p&gt;
&lt;p&gt;In this example, we have deployed a video processing pipeline to Kubernetes. The &lt;code class=&quot;language-text&quot;&gt;render&lt;/code&gt; service has a dependency on the &lt;code class=&quot;language-text&quot;&gt;encode-prod&lt;/code&gt; service, and we want to roll out a new version of &lt;code class=&quot;language-text&quot;&gt;encode&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;encode-test&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/031ce1539dfa83454bce2201ea1bec7e/e95bd/mirror.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 51.19798234552333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABkklEQVQoz42S7XKbMBBF8/7P5kwmnTSO26a1E9uABUZfgIQEp7Jw0vZHmy5zZzTAHN29uzfzPPMvwUVczzBNkX42DFiGYHDBZoXJ5+83/LXm5XkHLxUJdKLG71rsJDG+5jwcUa5agHGaOciRUgVOJnC2gUaNSPdubnE2J1T0SF8iPq2ZNppy/0ThvtH0r7TuuAB7P7Ha9vwQnrUY0V/O2NuC41nTR4vyVXbQJmknKPtn6ocN8UEi9s+oKJK7U/4nA7sEvH8dkF1g2waGdc300vL9fo1wBb0zxHnM7WenqWljBV15wsSa1h9o3AtmrK8Ox4nbXc+hHdnUyeFOYe4qRJPabzXFsaCzHc75DB3H1LaV2NCjtaJtW6SUDMPwK8NKB0TKr0n5KTchh4hOzmNME+17lFJUVZUAOk3Wo75W+HWTLq3z+7IsaZrmoyn/Wd57rLVoozmvdkxbzXb1RNUItNIIIRbgR3v4+8pkcEixPBaEzw2nfZkvqOs667+Ab0v9dh7HtFIqZWgspjPIa4aXaC71E+R5BpF6VBozAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;traffic mirroring&quot;
        title=&quot;traffic mirroring&quot;
        src=&quot;/static/031ce1539dfa83454bce2201ea1bec7e/b9e4f/mirror.png&quot;
        srcset=&quot;/static/031ce1539dfa83454bce2201ea1bec7e/cf440/mirror.png 148w,
/static/031ce1539dfa83454bce2201ea1bec7e/d2d38/mirror.png 295w,
/static/031ce1539dfa83454bce2201ea1bec7e/b9e4f/mirror.png 590w,
/static/031ce1539dfa83454bce2201ea1bec7e/f9b6a/mirror.png 885w,
/static/031ce1539dfa83454bce2201ea1bec7e/2d849/mirror.png 1180w,
/static/031ce1539dfa83454bce2201ea1bec7e/e95bd/mirror.png 1586w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We can use an Istio &lt;code class=&quot;language-text&quot;&gt;VirtualService&lt;/code&gt; to mirror all &lt;code class=&quot;language-text&quot;&gt;encode-prod&lt;/code&gt; traffic to &lt;code class=&quot;language-text&quot;&gt;encode-test&lt;/code&gt;. The client side Envoy proxy for &lt;code class=&quot;language-text&quot;&gt;render&lt;/code&gt; will then send requests to both &lt;code class=&quot;language-text&quot;&gt;encode-prod&lt;/code&gt; (request path) and &lt;code class=&quot;language-text&quot;&gt;encode-test&lt;/code&gt; (mirrored path). &lt;code class=&quot;language-text&quot;&gt;prod&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;test&lt;/code&gt; are two subsets of the &lt;code class=&quot;language-text&quot;&gt;encode&lt;/code&gt; Kubernetes service, specified in an Istio &lt;code class=&quot;language-text&quot;&gt;DestinationRule&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: &lt;code class=&quot;language-text&quot;&gt;render&lt;/code&gt; &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/api-v2/api/v2/route/route.proto#route-routeaction-requestmirrorpolicy&quot;&gt;will not wait&lt;/a&gt; to receive responses from &lt;code class=&quot;language-text&quot;&gt;encode-test&lt;/code&gt; — mirrored requests are “fire and forget.”&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; VirtualService
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; encode&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;mirror
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; encode
  &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; encode
        &lt;span class=&quot;token key atrule&quot;&gt;subset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; prod
      &lt;span class=&quot;token key atrule&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;mirror&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; encode
      &lt;span class=&quot;token key atrule&quot;&gt;subset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; DestinationRule
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; encode
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; encode
  &lt;span class=&quot;token key atrule&quot;&gt;subsets&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; prod
    &lt;span class=&quot;token key atrule&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; prod
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test
    &lt;span class=&quot;token key atrule&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[authorization]]></title><description><![CDATA[Authentication means verifying the identity of a client. Authorization, on the other hand, verifies the permissions of that client, or: “can…]]></description><link>https://istiobyexample.dev//authorization/</link><guid isPermaLink="false">https://istiobyexample.dev//authorization/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;Authentication means verifying the identity of a client. &lt;strong&gt;Authorization&lt;/strong&gt;, on the other hand, verifies the permissions of that client, or: “can this service do what they’re asking to do?”&lt;/p&gt;
&lt;p&gt;Kubernetes supports authorization through &lt;strong&gt;role-based access control&lt;/strong&gt; (&lt;a href=&quot;https://kubernetes.io/docs/reference/access-authn-authz/rbac/#api-overview&quot;&gt;RBAC&lt;/a&gt;). In this model, you can map a &lt;strong&gt;role&lt;/strong&gt; (a set of permissions) to a &lt;strong&gt;role binding&lt;/strong&gt; (who exactly has these permissions?).&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://istio.io/docs/concepts/security/#authorization&quot;&gt;Istio uses RBAC&lt;/a&gt; to allow you to set authorization policies between services in your cluster. Let’s see how.&lt;/p&gt;
&lt;p&gt;Here, the &lt;em&gt;ShoeStore&lt;/em&gt; application is deployed to the &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; Kubernetes namespace. There are three services, and all speak plain HTTP:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;shoes&lt;/code&gt;: exposes an API for all the shoes in the store&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;users&lt;/code&gt;: stores purchase history&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;inventory&lt;/code&gt;: loads new shoe models into &lt;code class=&quot;language-text&quot;&gt;shoes&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4728ec40e0fa8a81c959ef33674b4d45/c51b9/rbac.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 60.86885513637106%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAJnKAACZygHjkaQiAAAB/UlEQVQoz4WSW2+bQBCF8/9/Tp8q9aVSValprdhJcwM7EMdgMDbYYMxtd+frBnKxo6odaSSGmTlzduac8WIiwrE9x6LVSa7SNYsmwK89JuUV08qlMNvXjt7PjhvEGGS/Q/IUs5wjVTmUiRkGYFBGeNpXXGcBSa1Z7yHeC+sSbIqzvtA29IBNhXEu0c4E499B1/LRniuTULH96eOGBU4K043wO7bj5IUhR6RN6GEe3SHWuv8XtSue6oBSlTx0IaPRGJYl5+e3OLkmysFZvwCaQ4HZJph8Y5d0gGyNmd8zqzyCNmKUXzAuLnEPM7IupdAN86eCehwT+DW+BXvM4HbFAKiXPjrykSRgFk2Iv12RXI94qGbEdUyLICfHgrQSskNHZncYF5ah9c3BDDvU4QOSLqFcsfv0mTrIKS98+DWyY6cQ2NwiwGSZPZg9knrea4G0lpoU1i09Y3M66W/RA+qlh97Yprt7mnFEd7fA7FJbu0VmHuK4yHiCnI+QKEBlMdUPy36R0qgpbRvSNF6vhPcd7jaYtsQUOeZgpWPUqS67zrLq7HtXNF++0rpb6vuIqhjTqaUFnQ+A/MN6SZlXDb4rQdFQ3yS0fmi/N6hubQEfhycPOvy7v+n/OK5rjHdrhe9iLr6j4ylKtmhd/J/hB7oDS2VXEa+RGwe8ObT6pOwPV7adVod1XP4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;shoes rbac&quot;
        title=&quot;shoes rbac&quot;
        src=&quot;/static/4728ec40e0fa8a81c959ef33674b4d45/b9e4f/rbac.png&quot;
        srcset=&quot;/static/4728ec40e0fa8a81c959ef33674b4d45/cf440/rbac.png 148w,
/static/4728ec40e0fa8a81c959ef33674b4d45/d2d38/rbac.png 295w,
/static/4728ec40e0fa8a81c959ef33674b4d45/b9e4f/rbac.png 590w,
/static/4728ec40e0fa8a81c959ef33674b4d45/f9b6a/rbac.png 885w,
/static/4728ec40e0fa8a81c959ef33674b4d45/2d849/rbac.png 1180w,
/static/4728ec40e0fa8a81c959ef33674b4d45/c51b9/rbac.png 6123w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We want to authorize &lt;code class=&quot;language-text&quot;&gt;inventory&lt;/code&gt; to be able to &lt;code class=&quot;language-text&quot;&gt;POST&lt;/code&gt; new inventory to &lt;code class=&quot;language-text&quot;&gt;shoes&lt;/code&gt;, but not be able to access &lt;code class=&quot;language-text&quot;&gt;users&lt;/code&gt; at all. To do this, we will need three Istio resources.&lt;/p&gt;
&lt;p&gt;First, we need to enable authorization for the &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; Kubernetes namespace:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;rbac.istio.io/v1alpha1&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClusterRbacConfig
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; default
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;ON_WITH_INCLUSION&apos;&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;inclusion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;namespaces&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Second, we’ll define our &lt;code class=&quot;language-text&quot;&gt;ServiceRole&lt;/code&gt;, the abstract set of permissions to &lt;code class=&quot;language-text&quot;&gt;POST&lt;/code&gt; data to the &lt;code class=&quot;language-text&quot;&gt;shoes&lt;/code&gt; service:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;rbac.istio.io/v1alpha1&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServiceRole
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; shoes&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;user
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; default
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;rules&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;shoes.default.svc.cluster.local&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Lastly, we’ll bind this abstract &lt;code class=&quot;language-text&quot;&gt;shoes-user&lt;/code&gt; role to a concrete set of &lt;code class=&quot;language-text&quot;&gt;subjects&lt;/code&gt; — in this case, any request that has the &lt;code class=&quot;language-text&quot;&gt;hello:world&lt;/code&gt; HTTP header.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;rbac.istio.io/v1alpha1&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServiceRoleBinding
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; shoes&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;binding
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; default
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;subjects&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      request.headers&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;hello&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;world&quot;&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;roleRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServiceRole
    &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;shoes-user&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From here, the &lt;code class=&quot;language-text&quot;&gt;inventory&lt;/code&gt; service can only make requests to &lt;code class=&quot;language-text&quot;&gt;shoes&lt;/code&gt; with the &lt;code class=&quot;language-text&quot;&gt;hello:world&lt;/code&gt; header, and the &lt;code class=&quot;language-text&quot;&gt;users&lt;/code&gt; service is still locked down. This is because RBAC is on, but we haven’t assigned any &lt;code class=&quot;language-text&quot;&gt;ServiceRoles&lt;/code&gt; to access the &lt;code class=&quot;language-text&quot;&gt;users&lt;/code&gt; service.&lt;/p&gt;
&lt;p&gt;To learn more:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/docs/tasks/security/authz-http/#step-2-allowing-access-to-the-details-and-reviews-services&quot;&gt;Istio Authorization with Pod service accounts&lt;/a&gt; (requires mutual TLS)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/blog/2018/istio-authorization/#using-authenticated-client-identities&quot;&gt;End-user authorization&lt;/a&gt; through JWT claims&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/docs/tasks/security/authz-http/#enforcing-namespace-level-access-control&quot;&gt;Namespace-level authorization&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[external services]]></title><description><![CDATA[A service mesh often spans one environment— for instance, one Kubernetes cluster. And together, all the connected services in that…]]></description><link>https://istiobyexample.dev//external-services/</link><guid isPermaLink="false">https://istiobyexample.dev//external-services/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;A &lt;a href=&quot;https://istio.io/docs/concepts/what-is-istio/#what-is-a-service-mesh&quot;&gt;service mesh&lt;/a&gt; often spans one environment— for instance, one Kubernetes cluster. And together, all the connected services in that environment form the management domain of that mesh, from which you can view metrics and set policies.&lt;/p&gt;
&lt;p&gt;But what if you are also running services &lt;em&gt;outside&lt;/em&gt; the cluster, or you depend on external APIs?&lt;/p&gt;
&lt;p&gt;Have no fear. Istio provides a resource called a &lt;a href=&quot;https://istio.io/docs/concepts/traffic-management/#service-entries&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ServiceEntry&lt;/code&gt;&lt;/a&gt; that lets you logically bring external services into your mesh — even services you don’t own.&lt;/p&gt;
&lt;p&gt;When you create a ServiceEntry for an external hostname, you can view metrics and traces reaching all the way to that external service. You can even set traffic policies like &lt;a href=&quot;/retry/&quot;&gt;retry logic&lt;/a&gt; on those external services. Adding &lt;code class=&quot;language-text&quot;&gt;ServiceEntries&lt;/code&gt; effectively expands the reach of your Istio management domain. Let’s see an example.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1f1887d8d4790fe64dd6616441e58b2b/bafa1/currency.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50.16852039096731%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAJnKAACZygHjkaQiAAABX0lEQVQoz5WSW04DMQxFZ/fsgB++kdgAbIBVgBBFPNoymWcn47xzsTO0aqvygaUrOx8+uXFc4Z+Rcz7k43ofVYyA8/lPWZfx8Jhxe58RIk5g51BR9d1kbBtg2AH9uKgTDUuteuD6Dri6ydAkzfmi6wNQmq33sEmDwsR5hosElwzXVABkM+pWGhdA4GcZ50pfPgNXxdGsoUhhMCMa02L3vIF5UVx3+JzWWPVb1L00B5Cz7NQsUGsxTmyC4Skt6ALsf4FjnFGrDWilEFY9uqbGB63xNXZ4UxqjH/E+bKCaBkopeAbNWhcgWYfIlxwcttRAe8kt6FXBPSmQmcutMSzzlEj8rJmdEcuFUJyKBCi5zJCch4kaMwOJXdpAPJ8ZhufICPiQ0Q7Lh8gcZVYppQLwYVHkc3ly02dMbMS4xLecylhZHWCn98DTnbv02xU75TXJ6GVt9hqPlUsWl8cOL0niB08BC/8esVvwAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;external currency service&quot;
        title=&quot;external currency service&quot;
        src=&quot;/static/1f1887d8d4790fe64dd6616441e58b2b/b9e4f/currency.png&quot;
        srcset=&quot;/static/1f1887d8d4790fe64dd6616441e58b2b/cf440/currency.png 148w,
/static/1f1887d8d4790fe64dd6616441e58b2b/d2d38/currency.png 295w,
/static/1f1887d8d4790fe64dd6616441e58b2b/b9e4f/currency.png 590w,
/static/1f1887d8d4790fe64dd6616441e58b2b/f9b6a/currency.png 885w,
/static/1f1887d8d4790fe64dd6616441e58b2b/2d849/currency.png 1180w,
/static/1f1887d8d4790fe64dd6616441e58b2b/bafa1/currency.png 5934w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here, we’re running a global store website with a &lt;code class=&quot;language-text&quot;&gt;currency&lt;/code&gt; service, responsible for converting product prices based on a user’s locality. We rely on an third-party currency conversion API, the &lt;a href=&quot;https://www.ecb.europa.eu/stats/policy_and_exchange_rates/euro_reference_exchange_rates/html/index.en.html&quot;&gt;European Central Bank&lt;/a&gt;, to provide realtime exchange rates.&lt;/p&gt;
&lt;p&gt;We want to set a 3-second timeout on all calls from services inside the mesh to this external API. We’ll need two Istio resources to do this.&lt;/p&gt;
&lt;p&gt;First, a &lt;code class=&quot;language-text&quot;&gt;ServiceEntry&lt;/code&gt;, which logically adds the European Central Bank’s hostname, &lt;code class=&quot;language-text&quot;&gt;ecb.europa.eu&lt;/code&gt;, to the mesh:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServiceEntry
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; currency&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;api
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; www.ecb.europa.eu
  &lt;span class=&quot;token key atrule&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; http
    &lt;span class=&quot;token key atrule&quot;&gt;protocol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; HTTP
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;443&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; https
    &lt;span class=&quot;token key atrule&quot;&gt;protocol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; HTTPS&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Second, a &lt;code class=&quot;language-text&quot;&gt;VirtualService&lt;/code&gt; traffic rule, to set a timeout for calls to the API:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; VirtualService
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; currency&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;timeout
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; www.ecb.europa.eu
  &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 3s
    &lt;span class=&quot;token key atrule&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; www.ecb.europa.eu
        &lt;span class=&quot;token key atrule&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Once we create a ServiceEntry for the currency API, we can automatically see &lt;code class=&quot;language-text&quot;&gt;ecb.europa.eu&lt;/code&gt; in our &lt;a href=&quot;https://istio.io/docs/tasks/telemetry/kiali/&quot;&gt;Kiali service graph&lt;/a&gt; (and instantly know &lt;em&gt;who&lt;/em&gt;’s calling it):&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/74cae8deb37ee425ce2ccda62a758c27/b4b41/servicegraph.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 54.52505609573672%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABiklEQVQoz5VS7U7CQBDkUaBAKVYRsCKK0RdX30ESFPhhNJG2GBIjAr2PtuPtQiuC/vCayW4ve7Mzmy2UbQf17jXanodSyTIooVgswrIsRrlcRqVSQbVaZVBu2zaDcsdxGLVaDa7rouC2Oqi3ztDq9HBze4f7fh+DwQDj8Rij0QjD4ZCR5RR377dRaJ72YLstUHx6foFOASEElFKI4xj/PUzoNjtodi7xMHrE22yK+eecMQl8jkSstWZkjbK7LM+wJjS2G945Xic+VKKxUksIHeFjtYDUEqn5kiTJVaQp/acc9xQSkdPwDOEFgjDMH8SJ6ZjGULHkXEjBCpI04VwpzXWkmJolm5wJD9tdY7kHPwiYMFNDj4lQaLGnJN001nptld6wZSIjtLtX8P1vwm07kVwhNLNd8AgEprMZFsslN5RS8ixzy7WjE1QOmjg2swyC8IfCnNREaezo3LJEZDaByKJovRFUSyjQ/Kq0Nmw53FP42+CzowxhOHs3m7DI6/4k3CbLuu9ib67m7gtrQ+GdPFf8hwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;service graph&quot;
        title=&quot;service graph&quot;
        src=&quot;/static/74cae8deb37ee425ce2ccda62a758c27/b9e4f/servicegraph.png&quot;
        srcset=&quot;/static/74cae8deb37ee425ce2ccda62a758c27/cf440/servicegraph.png 148w,
/static/74cae8deb37ee425ce2ccda62a758c27/d2d38/servicegraph.png 295w,
/static/74cae8deb37ee425ce2ccda62a758c27/b9e4f/servicegraph.png 590w,
/static/74cae8deb37ee425ce2ccda62a758c27/f9b6a/servicegraph.png 885w,
/static/74cae8deb37ee425ce2ccda62a758c27/2d849/servicegraph.png 1180w,
/static/74cae8deb37ee425ce2ccda62a758c27/b4b41/servicegraph.png 2674w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And we also get an automatic &lt;a href=&quot;https://istio.io/docs/tasks/telemetry/metrics/using-istio-dashboard/&quot;&gt;Grafana dashboard&lt;/a&gt; for this external service, to view data like response codes and latency:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/765399be3d8aab886e29b2007d8a6516/9d68f/grafana.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 38.773079213817745%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABY0lEQVQoz2VRa0/DMAzsl21IIBil7zZpk6aPlQ1auiH+/x87zpkqIfHBOju5u9hxEL88orYdmsbCuh6qaZFkJdKcUSjmhceYGCUZ0pK5IGvR6NrA2hZDW8M0BsHT8xFxXnlCnBbIjEOmGi9MiRmx/1hgxwmuH6H4aBSn3lRQ4i1KEEZE5kEYhojjDDlNc+kqzZEwMj4gtYRWGmVZQVUKZUEeO5YGtti0ogmOx1cobXAa37Fef2DbHjXHMOz0cpl59g3nBo7XoutOGIYJ03RhPsJ1AzS1wpuXG2pygsPhwR9a/uMwnlHTSOmGphYtzfv+5M3kEcdxxVzMhC86CeG5fuJ/WgT7/cGLRbiuN0+UWvB8/sSyXL2BmApHzuZ59SbC09r6Dpev73uHYlipGooLaEzr86q6h++UmxS8TzD5rzDkyQMbT2rrRmobBLvd3m9s29qWbyGbU1pz1I5C++/+77Yl/wUC2NhIhooNPwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;grafana&quot;
        title=&quot;grafana&quot;
        src=&quot;/static/765399be3d8aab886e29b2007d8a6516/b9e4f/grafana.png&quot;
        srcset=&quot;/static/765399be3d8aab886e29b2007d8a6516/cf440/grafana.png 148w,
/static/765399be3d8aab886e29b2007d8a6516/d2d38/grafana.png 295w,
/static/765399be3d8aab886e29b2007d8a6516/b9e4f/grafana.png 590w,
/static/765399be3d8aab886e29b2007d8a6516/f9b6a/grafana.png 885w,
/static/765399be3d8aab886e29b2007d8a6516/2d849/grafana.png 1180w,
/static/765399be3d8aab886e29b2007d8a6516/9d68f/grafana.png 3358w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://istio.io/docs/tasks/traffic-management/egress/egress-control/#manage-traffic-to-external-services&quot;&gt;See the Istio docs&lt;/a&gt; to learn more about managing and securing external services.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[grpc]]></title><description><![CDATA[gRPC is a communication protocol for services, built on HTTP/2. Unlike REST over HTTP/1, which is based on resources, gRPC is based on…]]></description><link>https://istiobyexample.dev//grpc/</link><guid isPermaLink="false">https://istiobyexample.dev//grpc/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://grpc.io/&quot;&gt;gRPC&lt;/a&gt; is a communication protocol for services, built on &lt;a href=&quot;https://www.cncf.io/blog/2018/08/31/grpc-on-http-2-engineering-a-robust-high-performance-protocol/&quot;&gt;HTTP/2&lt;/a&gt;. Unlike REST over HTTP/1, which is based on &lt;a href=&quot;https://en.wikipedia.org/wiki/Representational_state_transfer&quot;&gt;resources&lt;/a&gt;, gRPC is based on &lt;a href=&quot;https://grpc.io/docs/guides/concepts/&quot;&gt;Service Definitions&lt;/a&gt;. You specify service definitions in a format called &lt;a href=&quot;https://developers.google.com/protocol-buffers/&quot;&gt;protocol buffers&lt;/a&gt; (“proto”), which can be serialized into an small binary format for transmission.&lt;/p&gt;
&lt;p&gt;With gRPC, you can generate boilerplate code from &lt;code class=&quot;language-text&quot;&gt;.proto&lt;/code&gt; files into &lt;a href=&quot;https://grpc.io/docs/quickstart/&quot;&gt;multiple programming languages&lt;/a&gt;, making gRPC an ideal choice for polyglot microservices.&lt;/p&gt;
&lt;p&gt;While gRPC supports some networking use cases like &lt;a href=&quot;https://grpc.io/docs/guides/auth/&quot;&gt;TLS&lt;/a&gt; and &lt;a href=&quot;https://grpc.io/blog/loadbalancing/&quot;&gt;client-side load balancing&lt;/a&gt;, adding Istio to a gRPC architecture can be useful for collecting telemetry, adding traffic rules, and setting &lt;a href=&quot;https://istio.io/blog/2018/istio-authorization/#rpc-level-authorization&quot;&gt;RPC-level authorization&lt;/a&gt;. Istio can also provide a useful management layer if your traffic is a mix of HTTP, TCP, gRPC, and database protocols, because you can use the same Istio APIs for all traffic types.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://istio.io/about/feature-stages/#traffic-management&quot;&gt;Istio&lt;/a&gt; and its data plane proxy, &lt;a href=&quot;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/other_protocols/grpc#arch-overview-grpc&quot;&gt;Envoy&lt;/a&gt;, both  support gRPC. Let’s see how to manage gRPC traffic with Istio.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/df7cd7dab819fa1db10d469a25e27819/624c6/grpc.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.75231676495367%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAJnKAACZygHjkaQiAAABH0lEQVQoz31Sa0+DQBDs//9dmhhjvzUxxBr1Q4XyOrj3k3GPKlJFL5nswc5Ohll22DrT6jpNV1g1Nkd3mSSdB7cOgqoOAQYJiupa4EswpQQZPzk+fM/5C38WrITCaCxaY2CVg3p4h+AGgXo+JtgQr8yPtYQvOAZr0WuDjsAIKQtm0okLtFKj8Ra6aBFeB7BDhbOXeGEt3sYBteboDNVgUe+PEHe3qJ869PSczTDC4rAUEopsM+9gSwG3L8GPHZrUo3Fn+kSBwQ/obAfyBvZYQd/co31uMMb4WzBbbpWeoSkfxdSczV/7GjmDPFEsqiYhg4HEMn8RXCNS6Dmx9OP9AupFW8LLA4IokGLO7sKft/zfb5PHtzY9nyBI2VwN5N4HZfNwqHP3/dwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;grpc&quot;
        title=&quot;grpc&quot;
        src=&quot;/static/df7cd7dab819fa1db10d469a25e27819/b9e4f/grpc.png&quot;
        srcset=&quot;/static/df7cd7dab819fa1db10d469a25e27819/cf440/grpc.png 148w,
/static/df7cd7dab819fa1db10d469a25e27819/d2d38/grpc.png 295w,
/static/df7cd7dab819fa1db10d469a25e27819/b9e4f/grpc.png 590w,
/static/df7cd7dab819fa1db10d469a25e27819/f9b6a/grpc.png 885w,
/static/df7cd7dab819fa1db10d469a25e27819/2d849/grpc.png 1180w,
/static/df7cd7dab819fa1db10d469a25e27819/624c6/grpc.png 5935w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here, we’re running two gRPC Services, &lt;code class=&quot;language-text&quot;&gt;client&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt;. &lt;code class=&quot;language-text&quot;&gt;client&lt;/code&gt; makes an RPC call to the &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt;’s &lt;code class=&quot;language-text&quot;&gt;/SayHello&lt;/code&gt; function every 2 seconds.&lt;/p&gt;
&lt;p&gt;Adding Istio to gRPC Kubernetes services has one pre-requisite: &lt;a href=&quot;https://istio.io/docs/setup/kubernetes/additional-setup/requirements/&quot;&gt;labeling&lt;/a&gt; your Kubernetes Service ports. The server’s port is labeled as follows:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Service
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; server
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; server
  &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClusterIP
  &lt;span class=&quot;token key atrule&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; grpc &lt;span class=&quot;token comment&quot;&gt;# important!&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;protocol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; TCP
    &lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8080&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Once we deploy the app, we can see this traffic between client and server in a &lt;a href=&quot;https://www.kiali.io/&quot;&gt;service graph&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2cc7e6ef92a4f359ae247e47ece8e510/54f11/kiali.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 35.11543134872418%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABFUlEQVQoz32RS2+DMBCE+f+nXqqqL+XQQxslf6QNVCqoh1g9VEEQASbhERvbGKbGbRVEUUda+bCrb2bXTt/3+K1B43faY4whDEMkSYLdbocoipCmKfI8R9u26LoODkaag4zFOQchBBnN4Ac+yAdBURb2jeMYSik4UkpQSiEa8QfAaoayLO3goCHBjM8okElY17V129M9Gt3gcDygqI5g6oTN+wu2ZAsp5Dml4lh4N7h1r3Bn6t69xuXzBV4j1/btylprCAPjiqGqK1Sn0sA5KMvsbWw6425TS4a1v8Tq7RGr4AnrYIkHbwHvc/MN7P/bYea2+BkX5gxtRAF1nhtMnelHzNUUqjuzUSsgOINqJXSvLWzofQE1AxnLSAsiIQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;kiali&quot;
        title=&quot;kiali&quot;
        src=&quot;/static/2cc7e6ef92a4f359ae247e47ece8e510/b9e4f/kiali.png&quot;
        srcset=&quot;/static/2cc7e6ef92a4f359ae247e47ece8e510/cf440/kiali.png 148w,
/static/2cc7e6ef92a4f359ae247e47ece8e510/d2d38/kiali.png 295w,
/static/2cc7e6ef92a4f359ae247e47ece8e510/b9e4f/kiali.png 590w,
/static/2cc7e6ef92a4f359ae247e47ece8e510/f9b6a/kiali.png 885w,
/static/2cc7e6ef92a4f359ae247e47ece8e510/2d849/kiali.png 1180w,
/static/2cc7e6ef92a4f359ae247e47ece8e510/54f11/kiali.png 1646w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We can also view the server’s gRPC traffic metrics in Grafana:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5d71c16e00c4e645b843e7b15602d1d3/362b5/server-healthy.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 37.42690058479532%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABa0lEQVQozz2Q61KDMBCFeYje24RAyAVCqUArl9ZedKqOOuMP3/9Zjktq/bHs7GbP4dsNxpMZhhj95cl0jtF4itl8CWNTyERBGwulDZS6xfB2n/Vamr/7BMNnNltgsVjR4IKaN7MV44iiCIIiDAWWyxU49QQXmNP7aHwz9Nol85qhDphQMK7Cumyg0gJMaEip4DKH1GY+4kiSscRDvUXdtCjKisg1GBNIiDhfb4jc+jrgpkLef6C7/qDo3xFmDXiyhnQN+ssndNGByZxEa5xejzheD2iPDYzJiDymn2tU1Q6JNL4OWKQRmwIqKyHtxhNGykG5GklaUr/2tRAxbJbD5QXdNKUTMU8khPR0Q16xkAjjFHl9wG7/Ald24NL5dXIS1vWO8sZTDCbdcY/D8wmPfQNLp+A8+if0K/NhZV3CtW9onr+RN1dwu0OoyaTYo718QT88gSUb2DRDf+7QnVts2xoxGd0Ny3Lr81D/AmmByrGFj507AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;server healthy&quot;
        title=&quot;server healthy&quot;
        src=&quot;/static/5d71c16e00c4e645b843e7b15602d1d3/b9e4f/server-healthy.png&quot;
        srcset=&quot;/static/5d71c16e00c4e645b843e7b15602d1d3/cf440/server-healthy.png 148w,
/static/5d71c16e00c4e645b843e7b15602d1d3/d2d38/server-healthy.png 295w,
/static/5d71c16e00c4e645b843e7b15602d1d3/b9e4f/server-healthy.png 590w,
/static/5d71c16e00c4e645b843e7b15602d1d3/f9b6a/server-healthy.png 885w,
/static/5d71c16e00c4e645b843e7b15602d1d3/2d849/server-healthy.png 1180w,
/static/5d71c16e00c4e645b843e7b15602d1d3/362b5/server-healthy.png 2394w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then, we can apply an Istio traffic rule to inject a 10-second delay &lt;a href=&quot;https://istio.io/docs/tasks/traffic-management/fault-injection/&quot;&gt;fault&lt;/a&gt; into &lt;code class=&quot;language-text&quot;&gt;server&lt;/code&gt;. You might apply this rule in a chaos testing scenario, to test the resiliency of this application.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.istio.io/v1alpha3
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; VirtualService
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; server&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;fault
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; server
  &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;fault&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;percentage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100.0&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;fixedDelay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 10s
    &lt;span class=&quot;token key atrule&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; server
        &lt;span class=&quot;token key atrule&quot;&gt;subset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This causes the client RPC to time out (&lt;code class=&quot;language-text&quot;&gt;Outgoing Request Duration&lt;/code&gt;):&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/30cf39c76b02540fad215f5f0eb110cc/f94bd/grafana-client-fault-inject.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50.168067226890756%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABxElEQVQoz2VS23LaMBD1RwQIxBdsS7ZsyZZlGGwgJOlM2obJ5P8/53R3S3hoH85ovdKey0K0WD5isSLQ+bBY4WG5utd8lkqjaS1M00r93f8Xy9VaeKLvxuP6CZtNgvUmvoN7cRwjTTMkcYKnW0/u1zfcaiFdrhFpXaMoFFrr0PUDus7DEbiu6xZZViBOtsgLDV3X6MOAYTfK6UO419rUyEuFiIcUk5aahpSABYpSSa8gIia1toPfB7TB/Y+BzOx7VMawQ4Mi19huS+S5EjBJWVbQVS1iTMjfbe/QeAsbOgETCbyDC70kiEpVwQ9kuw9wjlQqI8NMus1Lic01E3s/0g/kSMiIMJ9V3dBMA6VqMRVxrJbiMKG1vUARYZJu6RG5apwIdc7LHQ8xWNQYC8czbScCnCRi9lweFdLobYPPX7M8OM07fP6ecX2fcP054et6wss5kHON9x+zvPugu6+PIwLFzjJyaEyDMARqUGRy2lmL6RCE3PseL5cZz+cJx2mHeRqp1yHNcpyOB7y9ksDliCMJ985RMtoh72Sez5gIHDtN2elf+yEQyXwhPNOeWvpP5nLHO93tDtjvZ4zjROm0uCtpj38A6CcjzW7yn7AAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;grafana client fault inject&quot;
        title=&quot;grafana client fault inject&quot;
        src=&quot;/static/30cf39c76b02540fad215f5f0eb110cc/b9e4f/grafana-client-fault-inject.png&quot;
        srcset=&quot;/static/30cf39c76b02540fad215f5f0eb110cc/cf440/grafana-client-fault-inject.png 148w,
/static/30cf39c76b02540fad215f5f0eb110cc/d2d38/grafana-client-fault-inject.png 295w,
/static/30cf39c76b02540fad215f5f0eb110cc/b9e4f/grafana-client-fault-inject.png 590w,
/static/30cf39c76b02540fad215f5f0eb110cc/f9b6a/grafana-client-fault-inject.png 885w,
/static/30cf39c76b02540fad215f5f0eb110cc/2d849/grafana-client-fault-inject.png 1180w,
/static/30cf39c76b02540fad215f5f0eb110cc/f94bd/grafana-client-fault-inject.png 2380w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;To learn more about gRPC and Istio:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://istio.io/docs/concepts/traffic-management/#traffic-routing-and-configuration&quot;&gt;Istio docs - Traffic Management&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cloud.google.com/solutions/using-istio-for-internal-load-balancing-of-grpc-services&quot;&gt;Blog post - gRPC + Istio + Cloud Internal Load Balancer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>